{"version":3,"sources":["core/chain/translation-chain.js"],"names":[],"mappings":"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","file":"core/chain/translation-chain.js","sourcesContent":["import {\n  Chain\n}\nfrom './chain';\n\nimport {\n  TranslationChainElement\n}\nfrom './translation-chain-element';\n\nimport {\n  FallbackTranslator\n}\nfrom '../../translators/fallback-translator'\n\nimport {\n  TranslationResult\n}\nfrom '../types/translation-result';\n\nexport class TranslationChain {\n  constructor(fallbackTranslator) {\n    this.unitChain = new Chain();\n    this.magnitudeChain = new Chain();\n    this.finalResult = null;\n    this.currentValue = null;\n    this.fallbackTranslator = fallbackTranslator || new FallbackTranslator();\n  }\n\n  addUnit(unit) {\n    this.unitChain.addChainElement(new TranslationChainElement(unit));\n  }\n\n  addMagnitude(magnitude) {\n    this.magnitudeChain.addChainElement(new TranslationChainElement(magnitude));\n  }\n\n  isUnitChainNotEmpty() {\n    return this.unitChain.isNotEmpty();\n  }\n\n  isMagnitudeChainNotEmpty() {\n    return this.magnitudeChain.isNotEmpty();\n  }\n\n  translate(value) {\n    this.currentValue = value;\n    if (this.isUnitChainNotEmpty() || this.isMagnitudeChainNotEmpty()) {\n      this.performTranslation();\n      return this.finalResult.toString();\n    } else {\n      throw 'Units and/or magnitudes are not added';\n    }\n  }\n\n  performTranslation() {\n    this.finalResult = new TranslationResult();\n    if (this.isUnitChainNotEmpty()) {\n      this.performUnitAndMagnitudeTranslation();\n    } else {\n      this.performMagnitudeTranslation();\n    }\n  }\n\n  performUnitAndMagnitudeTranslation(isMagnitudeChainEmpty) {\n    //TODO: refactor\n    let result = this.unitChain.translate(this.currentValue);\n    if (result.isOverflow()) {\n      this.finalResult.setUnit(result.getWord());\n      this.currentValue = result.getDigitValue();\n      if (this.isMagnitudeChainNotEmpty()) {\n        this.performMagnitudeTranslation();\n      } else {\n        this.performFallbackTranslation();\n      }\n    } else if (result.isUnderflow()) {\n      this.finalResult.setDigitValue(result.getDigitValue());\n    } else {\n      this.finalResult.setUnit(result.getWord());\n      this.finalResult.setDigitValue(result.getDigitValue());\n    }\n  }\n\n  performMagnitudeTranslation() {\n    //TODO: refactor\n    let result = this.magnitudeChain.translate(this.currentValue);\n    if (result.isOverflow()) {\n      this.finalResult.increaseByMagnitude(result.getWord());\n      this.currentValue = result.getDigitValue();\n      this.performFallbackTranslation();\n    } else if (result.isUnderflow()) {\n      this.finalResult.setDigitValue(result.getDigitValue());\n    } else {\n      this.finalResult.setDigitValue(result.getDigitValue());\n      this.finalResult.increaseByMagnitude(result.getWord());\n    }\n  }\n\n  performFallbackTranslation(value) {\n    let result = this.fallbackTranslator.translate(this.currentValue);\n    this.finalResult.setDigitValue(result.digitValue);\n  }\n}\n"],"sourceRoot":"/source/"}